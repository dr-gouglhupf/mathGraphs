var grath=function(q,r){var t=this.options={size:{width:function(){return window.innerHeight<window.innerWidth?window.innerHeight-20:window.innerWidth-20},height:function(){return window.innerHeight<window.innerWidth?window.innerHeight-20:window.innerWidth-20}},gridSettings:{range:{xM:-10,xP:10,yM:-10,yP:10},colors:{axes:"#E4EDF0",temLines:"#7f8c8d",text:"#7f8c8d"},text:!0},toopTips:{enable:!0,roundEdges:!0,width:140,fontColor:"#e3f2fd",template:"P(<x(1)>, <y(1)>)<br>f(x) = <formula>"},fontType:"Arial",
changeOnResize:!0,randomColors:!0,colors:"rgb(26, 188, 156);rgb(46, 204, 113);rgb(52, 152, 219);rgb(155, 89, 182);rgb(52, 73, 94);rgb(22, 160, 133);rgb(39, 174, 96);rgb(41, 128, 185);rgb(142, 68, 173);rgb(44, 62, 80);rgb(241, 196, 15);rgb(230, 126, 34);rgb(231, 76, 60);rgb(243, 156, 18);rgb(211, 84, 0);rgb(192, 57, 43)".split(";")},k={},u=k.merge=function(a,b){"object"!==typeof a&&(a={});for(var c in b)if(b.hasOwnProperty(c)){var d=b[c];a[c]="object"===typeof d?k.merge(a[c],d):d}c=2;for(d=arguments.length;c<
d;c++)u(a,arguments[c]);return a};k.getRandomArbitrary=function(a,b){return Math.random()*(b-a)+a};k.complileTemplate=function(a){var b=[];a=a.split("<br>");for(var c=0;c<a.length;c++){var d="return '"+a[c].split("<").join("'+ dataset.").split(">").join("+'")+"'";b.push(new Function("dataset",d))}return b};var v=k.decimalAdjust=function(a,b,c){if("undefined"===typeof c||0===+c)return Math[a](b);b=+b;c=+c;if(isNaN(b)||"number"!==typeof c||0!==c%1)return NaN;b=b.toString().split("e");b=Math[a](+(b[0]+
"e"+(b[1]?+b[1]-c:-c)));b=b.toString().split("e");return+(b[0]+"e"+(b[1]?+b[1]+c:c))};Math.round10||(Math.round10=function(a,b){return v("round",a,b)});CanvasRenderingContext2D.prototype.roundRect=function(a,b,c,d,e,l,g){"undefined"==typeof g&&(g=!0);"undefined"===typeof e&&(e=5);this.beginPath();this.moveTo(a+e,b);this.lineTo(a+c-e,b);this.quadraticCurveTo(a+c,b,a+c,b+e);this.lineTo(a+c,b+d-e);this.quadraticCurveTo(a+c,b+d,a+c-e,b+d);this.lineTo(a+e,b+d);this.quadraticCurveTo(a,b+d,a,b+d-e);this.lineTo(a,
b+e);this.quadraticCurveTo(a,b,a+e,b);this.closePath();g&&this.stroke();l&&this.fill()};this.canvas=q.canvas;this.ctx=q;this.initialized=!1;this.functions=[];this.options=k.merge(t,r);this.functionsComp=k.complileTemplate(this.options.toopTips.template);this.canvasWidth=this.canvas.width=this.options.size.width();this.canvasHeight=this.canvas.height=this.options.size.height();this.drawGrid=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);var a=this.canvas.width,b=this.canvas.height,
c=this.options.gridSettings.range,d=-1*c.xM+c.xP+1,e=-1*c.yM+c.yP+1,l=a/d,g=b/e,h=l*(-1*c.xM+1)-l/2,f=this.calculateY(g*(-1*c.yM+1)-g/2);this.ctx.restore();this.ctx.lineWidth=2;this.ctx.strokeStyle="#7f8c8d";this.ctx.beginPath();this.ctx.moveTo(0,f);this.ctx.lineTo(a,f);this.ctx.stroke();this.ctx.beginPath();this.ctx.moveTo(h,0);this.ctx.lineTo(h,b);this.ctx.stroke();this.ctx.save();for(a=0;a<d;a++)0!=a+c.xM&&this.drawUnitX(l*a+l/2,f,a+c.xM);for(a=e;0<=a;a--)0!=a+c.yM&&this.drawUnitY(h,this.calculateY(g*
a+g/2),a+c.yM);this.initialized=!0;this.middleX=h;this.middleY=f;this.unitsGapX=l;this.unitsGapY=g};this.calculateY=function(a){return this.canvasHeight-a};this.drawUnitX=function(a,b,c){this.ctx.lineWidth=2;this.ctx.strokeStyle=this.options.gridSettings.colors.axes;this.ctx.beginPath();this.ctx.moveTo(a,0);this.ctx.lineTo(a,this.canvasHeight);this.ctx.stroke();this.ctx.lineWidth=2;this.ctx.strokeStyle=this.options.gridSettings.colors.temLines;this.ctx.beginPath();this.ctx.moveTo(a,b-5);this.ctx.lineTo(a,
b+5);this.ctx.stroke();this.options.gridSettings.text&&(this.ctx.font="14px "+this.options.fontType,this.ctx.fillStyle=this.options.gridSettings.colors.text,this.ctx.fillText(c,a-this.ctx.measureText(c.toString()).width/2,b-10))};this.drawUnitY=function(a,b,c){this.ctx.lineWidth=2;this.ctx.strokeStyle=this.options.gridSettings.colors.axes;this.ctx.beginPath();this.ctx.moveTo(0,b);this.ctx.lineTo(this.canvasWidth,b);this.ctx.stroke();this.ctx.lineWidth=2;this.ctx.strokeStyle=this.options.gridSettings.colors.temLines;
this.ctx.beginPath();this.ctx.moveTo(a-5,b);this.ctx.lineTo(a+5,b);this.ctx.stroke();this.options.gridSettings.text&&(this.ctx.font="14px "+this.options.fontType,this.ctx.fillStyle=this.options.gridSettings.colors.text,this.ctx.fillText(c,a+10,b+5))};this.funGraph=function(a,b){var c,d,e,f=0,g=0,h=[],k=Math.round((this.canvasWidth-this.middleX)/4),m=Math.round(-this.middleX/4);e=math.compile(a);this.ctx.beginPath();this.ctx.lineWidth=2;this.ctx.strokeStyle=b;for(var n=m;n<=k;n++){c=4*n;d=this.unitsGapY*
e.eval({x:c/this.unitsGapX});if(0<=this.middleY-d)g>d&&0>this.middleY-g&&(h.push({x:this.middleX+f,y:this.middleY-g}),this.ctx.moveTo(this.middleX+f,this.middleY-g)),h.push({x:this.middleX+c,y:this.middleY-d}),this.ctx.lineTo(this.middleX+c,this.middleY-d);else if(n!=m&&g<d&&0<this.middleY-g){c+=4;e=this.unitsGapY*e.eval({x:c/this.unitsGapX});this.ctx.lineTo(this.middleX+c,this.middleY-e);h.push({x:this.middleX+c,y:this.middleY-e});break}f=c;g=d}this.ctx.stroke();return h};this.drawGraths=function(a){this.drawGrid();
this.functions=[];for(var b=0;b<a.length;b++){this.functions.push({formula:a[b]});try{this.options.randomColors?(this.functions[b].color=this.options.colors[Math.round(k.getRandomArbitrary(0,this.options.colors.length-1))],this.functions[b].points=this.funGraph(a[b],this.functions[b].color)):(this.functions[b].color=this.options.colors[b],this.functions[b].points=this.funGraph(a[b],this.options.colors[b]))}catch(c){"undefined"!==typeof this.errorElem?this.errorElem.innerHTML="<p>"+c.message+"</p>":
console.log(c.message)}}};this.resizeGraths=function(){this.drawGrid();for(var a=0;a<this.functions.length;a++)this.funGraph(this.functions[a].formula,this.functions[a].color)};this.addGraths=function(a){this.initialized||this.drawGrid();for(var b=this.functions.length,c=0;c<a.length;c++)this.functions.push({formula:a[c]});for(c=0;c<a.length;c++)try{this.options.randomColors?(this.functions[c+b].color=this.options.colors[Math.round(k.getRandomArbitrary(0,this.options.colors.length-1))],this.functions[c+
b].points=this.funGraph(a[c],this.functions[c+b].color)):(this.functions[c+b].color=this.options.colors[c+b],this.functions[c+b].points=this.funGraph(a[c],this.options.colors[c+b]))}catch(d){"undefined"!==typeof this.errorElem?this.errorElem.innerHTML="<p>"+d.message+"</p>":console.log(d.message)}};this.updateGraths=function(){this.drawGrid();for(var a=0;a<this.functions.length;a++){var b=this.functions[a].points;this.ctx.beginPath();this.ctx.lineWidth=2;this.ctx.strokeStyle=this.functions[a].color;
this.ctx.moveTo(b[0].x,b[0].y);for(var c=1;c<b.length;c++)this.ctx.lineTo(b[c].x,b[c].y);this.ctx.stroke()}};this.updateHover=function(a){a.preventDefault();a.stopPropagation();var b=parseInt(a.clientX-this.canvas.offsetLeft),c=parseInt(a.clientY-this.canvas.offsetTop),d,e,f=[];for(a=0;a<this.functions.length;a++)for(var f=this.functions[a].points,g=0;g<f.length;g++){d=f[g].x;e=f[g].y;if(12>b-d&&-12<b-d&&12>c-e&&-12<c-e){var h=this,b={x:function(a){return Math.round10((d-h.middleX)/h.unitsGapX,-1*
a)},y:function(a){return Math.round10((e-h.middleY)/h.unitsGapY*-1,-1*a)},formula:this.functions[a].formula};this.updateGraths();this.ctx.beginPath();this.ctx.fillStyle=this.functions[a].color;this.ctx.arc(d,e,3,0,2*Math.PI);this.ctx.fill();d=160>this.canvasWidth-d?d-160:d+5;e=90>e?e+5:e-85;this.ctx.shadowBlur=2;this.ctx.shadowColor="black";this.ctx.fillStyle=this.functions[a].color;this.options.toopTips.roundEdges?this.ctx.roundRect(d,e,150,35*this.functionsComp.length+5,5,!0,!1):this.ctx.fillRect(d,
e,150,35*this.functionsComp.length+5);this.ctx.shadowBlur=0;this.ctx.fillStyle=this.options.toopTips.fontColor;this.ctx.font="30px "+this.options.fontType;for(a=0;a<this.functionsComp.length;a++)this.ctx.fillText(this.functionsComp[a](b),d+5,e+25+35*a,140);this.hoverMenu=!0;return}this.hoverMenu&&(this.updateGraths(),this.hoverMenu=!1)}};var p=!1,m=0,f=this;this.options.toopTips.enable&&this.canvas.addEventListener("mousemove",function(a){0!=m||p||(f.updateHover(a),m+=1,window.setTimeout(function(){--m},
50))});this.options.changeOnResize&&(window.onresize=function(){if(f.canvasWidth!=f.options.size.width()||f.canvasHeight!=f.options.size.height())p=!0,f.canvasWidth=f.canvas.width=f.options.size.width(),f.canvasHeight=f.canvas.height=f.options.size.height(),f.resizeGraths(),p=!1});return this.exports};
